<div class="navbar navbar-expand-sm navbar-light navbar-lewagon">
  <div class="container-fluid">
    <a class="navbar-brand" href="<%= root_path %>">
      <img src="https://res.cloudinary.com/dneopsx5s/image/upload/v1721648083/VIVA_CITY_v0tse4.png" alt="Brand Logo" class="avatar-square"/>
    </a>

    <div class="collapse navbar-collapse" id="navbarSupportedContent1">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" href="<%= events_path %>">Browse Events</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="<%= new_event_path %>">Add your Event</a>
        </li>
      </ul>
    </div>

    <div class="search-input">
      <%= form_with url: events_path, method: :get, class: "d-flex" do %>
        <%= text_field_tag :query, params[:query], class: "form-control", placeholder: "Type something" %>
        <button type="submit" class="btn btn-primary"><i class="fa fa-search"></i></button>
      <% end %>
    </div>

    <div class="collapse navbar-collapse" id="navbarSupportedContent2">
      <ul class="navbar-nav me-auto">
        <% if user_signed_in? %>
          <li class="nav-item active">
            <%= link_to "Home", root_path, class: "nav-link" %>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="<%= pending_participations_path %>">Your Events</a>
          </li>
          <li class="nav-item dropdown">
            <% case current_user.email
               when 'john.doe@example.com'
                 avatar_url = "https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8Y29uY2VydHxlbnwwfHwwfHx8Mg%3D%3D"
               when 'jane.smith@example.com'
                 avatar_url = "https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OXx8eW9nYXxlbnwwfHwwfHx8Mg%3D%3D"
               when 'sara.bouiala@gmail.com'
                 avatar_url = "https://res.cloudinary.com/dneopsx5s/image/upload/v1724696216/Sara_Bouiala_pc2fnl.png"
               when 'othmanebenchekroun@gmail.com'
                 avatar_url = "https://res.cloudinary.com/dneopsx5s/image/upload/v1724696256/PHOTO_PRO_e0wcqa.png"
               else
                 avatar_url = "https://images.unsplash.com/photo-1621112904887-419379ce6824?q=80&w=2072&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
               end %>

            <img src="<%= avatar_url %>" class="avatar-square avatar-round dropdown-toggle" alt="User Avatar" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
              <%= link_to "Profile", user_path(current_user), class: "dropdown-item" %> <!-- Added Profile Link -->
              <%= link_to "Log out", destroy_user_session_path, data: { turbo_method: :delete }, class: "dropdown-item" %>
            </div>
          </li>
        <% else %>
          <li class="nav-item dropdown">
            <img class="avatar-square avatar-round dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" src="https://res.cloudinary.com/dneopsx5s/image/upload/v1723579182/icons8-user-menu-male-50_gaehpv.png" alt="Default Avatar">
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
              <%= link_to "Login", new_user_session_path, class: "dropdown-item" %>
            </div>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>
